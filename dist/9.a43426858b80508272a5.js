(window.webpackJsonp=window.webpackJsonp||[]).push([[9,6,30,31],{"0Pcb":function(e,t,i){"use strict";const s=function(){const e=window.navigator.userAgent;return window.location.href,function(e){const t={},i=e.indexOf("iPhone")>=0||e.indexOf("iPad")>=0||e.indexOf("iPod")>=0,s=e.indexOf("Android")>0;return t.ios=i,t.android=s,t.mobile=i||s,t.pc=!i&&!s,t}(e)}();t.a=s},"14PU":function(e,t,i){var s=i("8VZJ");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(s,n);s.locals&&(e.exports=s.locals)},"8VZJ":function(e,t,i){(t=e.exports=i("I1BE")(!1)).push([e.i,'.ZKHB3b7wcSwR8Wl6fTxfr{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:stretch;align-items:stretch;height:100%;overflow:hidden;opacity:0;transition:all .5s ease-out;will-change:opacity}._2p3_lfNbTv7jvNTjDcwiNG{margin:20px 10px;padding:0;display:block;float:left;width:calc(25vw - 20px);height:calc(25vw - 20px);display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._3PLz2jKWg5aqWZ0L2XSk1A{width:calc(100vw - 20px);height:calc(100vw - 20px)}._2Aqnhl0UilhQmcJ__tvzcs{-ms-flex:1 1 auto;flex:1 1 auto;width:50%;margin:20px;padding:20px;overflow:hidden;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;border:1px solid #4169e1;border-radius:10px}._3PcgzXzpkVz38FWGWVlBgF{-ms-flex:0 0 auto;flex:0 0 auto;height:42px;display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;overflow:auto}._1J5n2jI7d_iyhVCFsz6kGo{padding:0 10px;background:hsla(0,0%,40%,.6);color:hsla(0,0%,100%,.6);line-height:42px;border-right:1px solid #fff;cursor:pointer}._1J5n2jI7d_iyhVCFsz6kGo:hover{background:hsla(0,0%,40%,.4);color:#fff}.lG27D-ztuflQnRQrYzrEk{background:#f5f2f0;color:#3a73d1;padding:0 10px;line-height:42px;border-right:1px solid #fff;cursor:pointer}.lG27D-ztuflQnRQrYzrEk:hover{color:#0858db}._1Uc2dRqvsUOU-zqNfc0zoP{display:-ms-flexbox;display:flex;-ms-flex:1 1 auto;flex:1 1 auto;overflow:scroll;background:#f5f2f0}.uhY8gttG11j6aitIqgmsp{display:none}._1tG49ZjfMiBGC9SRfhiVb{display:block}._11qLAYl8YioCWH0Wa6nugG{-ms-flex:1 1 auto;flex:1 1 auto;margin:20px;padding:20px;width:50%;border:1px solid #4169e1;border-radius:10px;box-sizing:content-box}._3ddyhRKJ33suqfgO4btVi_{border:none;margin:0;padding:0;border-radius:0;display:block}._2p3_lfNbTv7jvNTjDcwiNG ._11qLAYl8YioCWH0Wa6nugG{margin:0;padding:10px;width:100%;height:100%;box-sizing:border-box;border:1px solid #4169e1;border-radius:10px}._3I7L3oK-Gj0uKsP2dcD9jc{position:fixed;top:calc(50% - 16px);left:calc(50% - 16px);width:32px;height:32px;border-radius:50%;background:#b3d4fc;animation:_2UXogTuqtyG9ZgCq7AZ_5F 1.8s ease infinite}._3I7L3oK-Gj0uKsP2dcD9jc:after,._3I7L3oK-Gj0uKsP2dcD9jc:before{content:"";display:block;position:absolute;height:inherit;width:inherit;background:inherit;border-radius:inherit;animation:_2UXogTuqtyG9ZgCq7AZ_5F 1.8s ease infinite}._3I7L3oK-Gj0uKsP2dcD9jc:before{left:calc(50% - 80px);background:#07a}._3I7L3oK-Gj0uKsP2dcD9jc:after{left:calc(50% + 48px);background:#690}.y1HRpH4VDRhNdBAt12eEI>._2Aqnhl0UilhQmcJ__tvzcs{display:none}._1gBDP-PRzphfndCrFoPJoO{opacity:1}.NMrsesPPXb57BISDZo4Q5{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._3925vOYf0GdFYymPirm6yB{color:red;font-weight:700;font-size:24px}._1PFQRcWzh5gn96QgIv6w9-{color:#999;font-size:12px}@keyframes _2UXogTuqtyG9ZgCq7AZ_5F{0%{top:calc(50% - 16px);transform:rotate(0deg)}50%{top:calc(50% - 80px);transform:rotate(-180deg)}to{top:calc(50% - 16px);transform:rotate(-1turn)}}',""]),t.locals={single:"ZKHB3b7wcSwR8Wl6fTxfr",collect:"_2p3_lfNbTv7jvNTjDcwiNG",collectMobile:"_3PLz2jKWg5aqWZ0L2XSk1A",codes:"_2Aqnhl0UilhQmcJ__tvzcs",codesTab:"_3PcgzXzpkVz38FWGWVlBgF",otherTab:"_1J5n2jI7d_iyhVCFsz6kGo",activeTab:"lG27D-ztuflQnRQrYzrEk",codesSection:"_1Uc2dRqvsUOU-zqNfc0zoP",otherSection:"uhY8gttG11j6aitIqgmsp",activeSection:"_1tG49ZjfMiBGC9SRfhiVb",result:"_11qLAYl8YioCWH0Wa6nugG",mobileResult:"_3ddyhRKJ33suqfgO4btVi_",loading:"_3I7L3oK-Gj0uKsP2dcD9jc",spin:"_2UXogTuqtyG9ZgCq7AZ_5F",mobile:"y1HRpH4VDRhNdBAt12eEI",loaded:"_1gBDP-PRzphfndCrFoPJoO",error:"NMrsesPPXb57BISDZo4Q5",errorTitle:"_3925vOYf0GdFYymPirm6yB",errorTip:"_1PFQRcWzh5gn96QgIv6w9-"}},"8xBV":function(e,t,i){"use strict";var s=i("J66h"),n=i("ysz4"),r=i("kZAv"),a=i("ai4s");var o=class{constructor(e){this.moduleName=e,this.sourcePath=`example/${e}/canvas`,this.requestPath="https://api.github.com/repos/snayan/canvas-demo/contents"}fetch(e){return fetch(`${this.requestPath}/${e}`,{credentials:"omit",method:"get",mode:"cors"})}async getCanvasFiles(){let e,t=[],i=a.a.get(this.moduleName);if(i&&i.length)return i;let s=await this.fetch(this.sourcePath);if(!s.ok)throw new Error(JSON.stringify({status:s.status,statusText:s.statusText,body:await s.text(),url:s.url}));e=await s.json();for(let i of e)"file"===i.type&&(s=await this.fetch(i.path)).ok&&t.push(await s.json());return a.a.set(this.moduleName,t),t}},l=i("0Pcb"),d=i("wZee"),c=i.n(d),h=i("14PU"),u=i.n(h);t.a=class{constructor(e){this.canvasInstances=[],this.moduleName=e,this.el=document.createElement("div"),this.isSingleModule=Object(n.c)(e),this.github=new o(e),this.link=`${r.c}?module=${e}`,l.a.mobile&&this.el.classList.add(u.a.mobile),window.addEventListener("resize",Object(n.e)(this.render.bind(this),100),!1)}loading(){let e=document.createElement("i");return e.classList.add(u.a.loading),document.body.appendChild(e),()=>{document.body.removeChild(e)}}renderCanvas(){let e=this.canvasInstances.length,t=document.createElement("div");t.classList.add(u.a.result),l.a.mobile&&t.classList.add(u.a.mobileResult),this.el.appendChild(t),e>0&&setTimeout(()=>{let{width:i,height:s}=t.getBoundingClientRect(),n=i>s,r=document.createElement("div");r.style.display="inline-block",n?(r.style.width=`${100/e}%`,r.style.height="100%"):(r.style.width="100%",r.style.height=`${100/e}%`);for(let e of this.canvasInstances){let i=r.cloneNode();t.appendChild(i),e.render(i)}},0)}async renderCode(){let e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("nav"),n=[],r=[],a="0";try{let e=await this.github.getCanvasFiles();for(let[t,{name:i,content:a}]of e.entries())n.push(`<span class='${0===t?u.a.activeTab:u.a.otherTab}' data-index='${t}'>${i}</span>`),r.push(`<div class='${0===t?u.a.activeSection:u.a.otherSection}' data-index='${t}' ><pre class="language-typescript">${c.a.highlight(s.Base64.decode(a),c.a.languages.javascript,"typescript")}</pre></div>`)}catch(e){let t=JSON.parse(e.message);r.push(`<div class='${u.a.error}'><h4 class='${u.a.errorTitle}'>[${t.status}]${t.statusText}</h4><p class='${u.a.errorTip}'>${t.url}</p></div>`)}i.addEventListener("click",e=>{let s=e.target.dataset.index;if(s===a)return!1;let n=i.querySelectorAll("span"),r=t.querySelector(`div[data-index='${a}']`),o=t.querySelector(`div[data-index='${s}']`);for(let e of n)e.className=e.dataset.index===s?u.a.activeTab:u.a.otherTab;return r.className=u.a.otherSection,o.className=u.a.activeSection,a=s,!1}),i.className=u.a.codesTab,i.innerHTML=n.join(""),e.appendChild(i),t.className=u.a.codesSection,t.innerHTML=r.join(""),e.appendChild(t),e.className=u.a.codes,this.el.appendChild(e)}async render(){let e=this.loading();if(this.el.innerHTML="",document.body.appendChild(this.el),this.isSingleModule)this.el.classList.add(u.a.single),l.a.pc&&await this.renderCode();else{this.el.classList.add(u.a.collect);let e=document.createElement("a");e.innerText=this.moduleName,e.href=this.link,e.style.marginTop="10px",this.el.appendChild(e)}return l.a.mobile&&!this.isSingleModule&&this.el.classList.add(u.a.collectMobile),this.renderCanvas(),e(),setTimeout(()=>{this.el.classList.add(u.a.loaded)},0),this}}},Dd8r:function(e,t,i){"use strict";i.r(t);var s=i("Qb4n"),n=i("0Pcb"),r=i("ysz4"),a=i("w69y");t.default=class extends s.a{constructor(){super(),this.ctx=this.getContext("2d"),this.letterSpace=0,this.fontSize=n.a.pc?24:16,this.lineHeight=2*this.fontSize,this.margin=20,this.lines=[],this.nextWord={lineNum:0,wordIndex:0},this.focus=!1}calculateLines(){let{lineHeight:e,editorAreaLeft:t,editorAreaTop:i,editorAreaWidth:s}=this;for(let n=0,r=this.lines.length;n<r;n++)this.lines[n]={left:t,bottom:i+e*(n+1)+.5,width:s,height:e,words:[]}}calculateWordWidth(){let{ctx:e}=this;return e.measureText("M").width}calculateLetterSpace(){let{ctx:e,lines:t}=this,i=this.calculateWordWidth(),s=t[0].width,n=Math.floor(s/i);this.letterSpace=(s-n*i)/(n-1)}calculateEditorArea(){let{margin:e,lineHeight:t,width:i,height:s}=this,n=Math.floor((s-2*e-t)/t);this.lines.length=n,this.editorAreaLeft=e,this.editorAreaTop=e+t,this.editorAreaWidth=i-2*e,this.editorAreaHeight=n*t}isPointInEditor(e,t){let{ctx:i,margin:s,editorAreaLeft:n,editorAreaTop:r,editorAreaWidth:a,editorAreaHeight:o}=this;return i.rect(n,r-.5,a,o-1),i.isPointInPath(e,t)}measureLineText(e,t){let{ctx:i,lines:s,letterSpace:n}=this,r=s[e].words;return!r.length||t<0?0:i.measureText(r.slice(0,t+1).join("")).width+n*t}calculateNextWord(e,t){let{ctx:i,lines:s,editorAreaLeft:n}=this,r=this.findLineByPoint(e,t),a=s[r];if(a){let t=a.words.length,i=0,s=this.measureLineText(r,i);for(;s<e-n&&i<t;)i+=1,s=this.measureLineText(r,i);this.nextWord={lineNum:r,wordIndex:i}}}advanceNextWord(){let{nextWord:e,lines:t,editorAreaWidth:i,letterSpace:s}=this,{lineNum:n,wordIndex:r}=e,a=(t[n],this.calculateWordWidth());this.measureLineText(n,r)+a+s>i?(n+=1,r=0):r+=1,this.nextWord={lineNum:n,wordIndex:r}}reorganizeWords(e){let t,{lines:i,editorAreaWidth:s}=this;for(let n=e,r=i.length;n<r;n++)for(let e=0,a=i[n].words.length;e<a;e++)this.measureLineText(n,e)>s&&(t=i[n].words.slice(e),i[n].words=i[n].words.slice(0,e),n<r-1&&(i[n+1].words=[...t,...i[n+1].words]))}findLineByPoint(e,t){let{editorAreaTop:i}=this;if(!this.isPointInEditor(e,t))return-1;let s=t-i;return Math.floor(s/this.lineHeight)}addWord(e){let{ctx:t,lines:i,letterSpace:s,nextWord:n}=this,{lineNum:r,wordIndex:a}=n,o=i[r].words;a=Math.min(a,o.length),o.splice(a,0,e),this.advanceNextWord(),this.reorganizeWords(r)}removeWord(){let{nextWord:e,lines:t}=this,{lineNum:i,wordIndex:s}=e;0===s?0!==i&&t[i-1].words.length&&(s=t[i-=1].words.length-1):s-=1,t[i].words.splice(s,1),this.nextWord={lineNum:i,wordIndex:s}}changeLine(){let{nextWord:e,lines:t}=this,{lineNum:i,wordIndex:s}=e;i<t.length-1&&(i+=1),this.nextWord={lineNum:i,wordIndex:s},this.drawCursor()}bindFocusEvent(){this.container.addEventListener("click",e=>{let{x:t,y:i}=Object(r.h)(this.el,e.x,e.y);this.isPointInEditor(t,i)&&(this.focus=!0,this.calculateNextWord(t,i),this.drawCursor())},!1)}bindInputEvent(){window.addEventListener("keyup",e=>{let{key:t,keyCode:i}=e,{ctx:s,focus:n,editorAreaWidth:r,letterSpace:a}=this;return!!n&&(8===i?this.removeWord():13===i?this.changeLine():this.addWord(t),this.draw(),!0)})}drawPaper(){let{ctx:e,lines:t,lineHeight:i}=this;e.save(),e.strokeStyle="rgba(0,0,0,0.5)",e.beginPath();let s=t[0];s&&(e.moveTo(s.left,s.bottom-i),e.lineTo(s.left+s.width,s.bottom-i));for(let{left:i,bottom:s,width:n,height:r}of t)e.moveTo(i,s),e.lineTo(i+n,s);e.stroke(),e.restore()}drawDateHeader(){let{ctx:e,lines:t,lineHeight:i}=this,s=t[0];if(e.save(),e.fillStyle="#666",s){let t=new Date,n="DATEï¼š"+t.getFullYear()+" - "+("0"+(t.getMonth()+1)).slice(-2)+" - "+("0"+t.getDate()).slice(-2),r=e.measureText(n).width;e.fillText(n,s.left+s.width-r-10,s.bottom-i-10)}e.restore()}drawWords(){let e,{ctx:t,lines:i,letterSpace:s}=this;for(let n=0,r=i.length;n<r;n++){let{words:r,left:a,bottom:o}=i[n];for(let i=0,l=r.length;i<l;i++)e=this.measureLineText(n,i-1),i>0&&(e+=s),t.fillText(r[i],a+e,o)}}drawCursor(){let{cursor:e,focus:t,nextWord:i,lines:s,letterSpace:n}=this;if(t){let{lineNum:t,wordIndex:n}=i,r=s[t];e.move(r.left+this.measureLineText(t,n-1),r.bottom)}}erase(){let{ctx:e,width:t,height:i}=this;e.clearRect(0,0,t,i)}draw(){let{ctx:e}=this;this.erase(),this.drawPaper(),this.drawDateHeader(),this.drawCursor(),this.drawWords()}render(e){super.render(e),this.ctx.font=`${this.fontSize}px sans-serif`,this.ctx.lineWidth=.5,this.ctx.textBaseline="bottom",this.cursor=new a.default(this.ctx),this.calculateEditorArea(),this.calculateLines(),this.calculateLetterSpace(),this.bindFocusEvent(),this.bindInputEvent(),this.draw()}}},Qb4n:function(e,t,i){"use strict";var s=i("kZAv");t.a=class{constructor(){this.el=document.createElement("canvas")}initCanvasSize(e,t){this.el.width=e,this.el.height=t,this.width=e,this.height=t}getContext(e,t){return this.el.getContext(e,t)}render(e){this.container=e;let{width:t,height:i}=e.getBoundingClientRect();this.initCanvasSize(t||s.d,i||s.b),this.container.innerHTML="",this.container.appendChild(this.el)}}},kZAv:function(e,t,i){"use strict";i.d(t,"d",function(){return s}),i.d(t,"b",function(){return n}),i.d(t,"a",function(){return r}),i.d(t,"c",function(){return a});const s=500,n=500,r=`${i("0Pcb").a.pc?24:16}px sans-serif`,a="https://snayan.github.io/canvas-demo/"},"l6y/":function(e,t,i){"use strict";i.r(t);var s=i("8xBV"),n=i("ysz4"),r=i("Dd8r");const a="editor";class o extends s.a{constructor(){super(a),this.canvasInstances.push(new r.default)}}Object(n.c)(a)&&(new o).render(),t.default=o},w69y:function(e,t,i){"use strict";i.r(t);t.default=class{constructor(e,t={}){this.ctx=e,this.width=t.width||1,this.height=t.height||this.getHeight(),this.fillStyle="rgba(0,0,0,0.8)",this.blinkOn=500,this.blinkOff=500,this.lastShowTime=0}getHeight(){let{ctx:e}=this,t=e.measureText("M").width;return t+t/6}erase(){let{ctx:e,imgData:t,width:i,height:s,left:n,bottom:r}=this;t&&e.putImageData(t,0,0,n-1,r-s-1,i+2,s+2)}draw(){let{ctx:e,left:t,bottom:i,width:s,height:n,fillStyle:r}=this;e.save(),e.fillStyle=r,e.lineWidth=s,e.fillRect(t,i-n,s,n),e.restore()}blink(e){let{ctx:t,blinkOn:i,blinkOff:s,lastShowTime:n}=this,r=e-n;r>i+s?(this.draw(),this.lastShowTime=e):r>i&&this.erase(),this.timer=window.requestAnimationFrame(this.blink.bind(this))}move(e,t){let{ctx:i,width:s,height:n,timer:r}=this;this.erase(),this.imgData=i.getImageData(0,0,i.canvas.width,i.canvas.height),this.left=e,this.bottom=t,this.lastShowTime=0,window.cancelAnimationFrame(r),this.blink(performance.now())}}}}]);